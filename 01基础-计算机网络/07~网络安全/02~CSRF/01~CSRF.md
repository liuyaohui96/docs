## CSRF(Cross-site request forgery)
跨站请求伪造。非源站点按照源站点数据请求格式将非法数据提交到源站点服务器。如用户登录了受信任网站A，在不登出A的情况下，访问危险网站B，网站B通过设置陷阱，窃取和修改用户网站A的信息。

CSRF 攻击必须要有三个条件：
* 用户已经登录了站点 A，并在本地记录了 cookie
* 在用户没有登出站点 A 的情况下（也就是 cookie 生效的情况下），访问了恶意攻击者提供的引诱危险站点 B (B 站点要求访问站点A)。
* 站点 A 没有做任何 CSRF 防御

## 防范办法
* Get 请求不对数据进行修改
* 不让第三方网站访问到用户 Cookie
    * 可以对 Cookie 设置 SameSite 属性。该属性表示 Cookie 不随着跨域请求发送，可以很大程度减少 CSRF 的攻击，但是该属性目前并不是所有浏览器都兼容。
* 阻止第三方网站请求接口
    * HTTP Referer header：通过检查http包头referer的值是不是这个页面，来判断是不是CSRF攻击。某些情况下如从https跳转到http，浏览器处于安全考虑，不会发送referer，服务器就无法进行check了。若与该网站同域的其他网站有XSS漏洞，那么攻击者可以在其他网站注入恶意脚本，受害者进入了此类同域的网址，也会遭受攻击。出于以上原因，无法完全依赖Referer Check作为防御CSRF的主要手段。但是可以通过Referer Check来监控CSRF攻击的发生。
* 增加安全验证
    * 验证 HTTP Referer 字段,判断请求来源
    * token：发送请求时在HTTP 请求中以参数的形式加入一个随机产生的token，并在服务器建立一个拦截器来验证这个token。服务器读取浏览器当前域cookie中这个token值，会进行校验该请求当中的token和cookie当中的token值是否都存在且相等，才认为这是合法的请求。否则认为这次请求是违法的，拒绝该次服务。
    * 验证码,用户体验虽然不好,但是很多场合下可以防范大多数攻击。但是验证码降低了用户的体验，网站不能给所有的操作都加上验证码。所以只能将验证码作为一种辅助手段，在关键业务点设置验证码

任何防范都有代价的,比如验证码造成的体验不好,token滥用造成的性能问题,轮询替换造成的响应时间等