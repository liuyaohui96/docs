## 重绘与回流
1. 重绘：外观背景色等的操作不会引发布局变化导致重新渲染
2. 回流：DOM 树的结构变化以及几何属性的变化会导致页面重新渲染，当尽力避免回流来优化性能

回流必将引起重绘，重绘不一定会引起回流，回流比重绘的代价要更高



前提：
1. 浏览器使用流式布局模型 (Flow Based Layout)
2. HTML解析成DOM，把CSS解析成CSSOM，DOM和CSSOM合并就产生了Render Tree
3. 根据 RenderTree，计算他们在页面上的大小和位置和样式，最后把节点绘制到页面上

## 导致重绘(repaint)的操作  
页面中元素样式的改变并不影响它在文档流中的位置时（例如：color、background-color、visibility等），浏览器会将新样式赋予给元素并重新绘制它，这个过程称为重绘

## 导致回流(reflow)的操作
Render Tree中部分或全部元素的尺寸、结构、或某些属性发生改变时，浏览器重新渲染部分或全部文档的过程称为回流。

* 页面首次渲染
* 浏览器窗口大小发生改变
* 添加或者删除可见的DOM元素
* 元素盒子模型尺寸变化
  * 元素尺寸改变——边距、填充、边框、宽度和高度
  * 元素内容变化（文字数量或图片大小等等）
  * 元素字体大小变化
* 激活CSS伪类（例如：:hover）
* 计算 offsetWidth 和 offsetHeight 属性



## 如何避免重绘与回流
1. CSS
  - 不要使用 table 布局，可能很小的一个小改动会造成整个 table 的重新布局
  - CSS 选择符从右往左匹配查找，避免节点层级过多
  - visibility 替换 display: none ，因为前者只会引起重绘，后者会引发回流（改变了布局）
  - 动画效果应用到position属性为absolute或fixed的元素上
  - 避免使用CSS表达式（例如：calc()）

2. JavaScript
  - 避免频繁操作样式，避免频繁操作DOM。先为元素设置display: none，操作结束后再把它显示出来。因为在display属性为none的元素上进行的DOM操作不会引发回流和重绘
  - 对具有复杂动画的元素使用绝对定位，使它脱离文档流