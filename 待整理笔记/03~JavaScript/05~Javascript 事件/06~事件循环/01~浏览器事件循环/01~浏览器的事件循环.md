
## 浏览器事件循环
异步任务之间并不相同，因此他们的执行优先级也有区别不同的异步任务被分为两类：微任务（micro task）和宏任务（macro task）。宏任务队列可以有多个，微任务队列只有一个。

常见的macrotasks: setTimeout, setInterval, setImmediate, script（整体代码）, I/O, UI rendering

常见的microtasks: Promise，process.nextTick（Node独有）, MutationObserver(html5新特性) 

关键概念：
* 执行上下文与执行上下文栈：调用函数的时候会产生一个函数执行上下文，因为js是单线程的，同一时间只能执行一个方法，于是这些方法被排队在一个单独的地方。这个地方被称为执行上下文栈。
* 任务队列：JavaScript 引擎遇到一个异步事件后并不会一直等待其返回结果，而是会将这个事件挂起，加入与当前执行栈不同的另一个队列，我们称之为事件队列（任务队列）

事件循环过程：
* 一开始全局上下文（script全局代码）推入执行上下文栈，执行同步代码，如果遇到异步任务，将其分配到相应的macro-task 与 micro-task队列
* 当主线程处于闲置状态时（前一个宏任务已经完成），主线程会去查找事件队列是否有任务。如果有，依次**执行完微任务**，再依次执行宏任务队列最前面的一个，执行宏任务过程中，更新任务队列，执行完后，依次**执行完微任务**，再依次执行宏任务队列最前面的一个... 依次类推，直到任务队列被清空